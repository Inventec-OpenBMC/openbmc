From 244a0d96f1089d01eb4a96986938b98c2d4dc4ee Mon Sep 17 00:00:00 2001
From: anonymous <anonymous@inventec.com>
Date: Mon, 18 May 2020 20:06:14 -0400
Subject: [PATCH] Initial-u-boot-fw-utility

---
 arch/arm/dts/Makefile             |  1 +
 configs/goldentalon-ast2600_defconfig | 74 +++++++++++++++++++++++++++++++++++++++
 include/configs/aspeed-common.h   |  5 ++-
 include/configs/evb_ast2600a0.h   |  5 +++
 4 files changed, 84 insertions(+), 1 deletion(-)
 create mode 100644 configs/goldentalon-ast2600_defconfig

diff --git a/arch/arm/dts/Makefile b/arch/arm/dts/Makefile
index e9d9947..4c21dc2 100755
--- a/arch/arm/dts/Makefile
+++ b/arch/arm/dts/Makefile
@@ -681,6 +681,7 @@ dtb-$(CONFIG_ARCH_ASPEED) += \
 	ast2600a0-ncsi.dtb \
 	ast2600a1-evb.dtb \
 	ast2600a1-ncsi.dtb \
+        ast2600-goldentalon.dtb \
 	ast2600-fpga.dtb \
 	ast2600-rainier.dtb \
 	ast2600-slt.dtb \
diff --git a/configs/goldentalon-ast2600_defconfig b/configs/goldentalon-ast2600_defconfig
new file mode 100644
index 0000000..9b6e585
--- /dev/null
+++ b/configs/goldentalon-ast2600_defconfig
@@ -0,0 +1,74 @@
+CONFIG_ARM=y
+CONFIG_ARCH_ASPEED=y
+CONFIG_SYS_TEXT_BASE=0x0
+CONFIG_ASPEED_AST2600=y
+CONFIG_SYS_MALLOC_F_LEN=0x2000
+CONFIG_ARMV7_BOOT_SEC_DEFAULT=y
+CONFIG_NR_DRAM_BANKS=1
+CONFIG_FIT=y
+CONFIG_USE_BOOTARGS=y
+CONFIG_BOOTARGS="console=ttyS4,115200n8 root=/dev/ram rw mem.devmem=1"
+CONFIG_PRE_CONSOLE_BUFFER=y
+CONFIG_PRE_CON_BUF_ADDR=0x10000000
+CONFIG_DISPLAY_BOARDINFO_LATE=y
+CONFIG_ARCH_EARLY_INIT_R=y
+CONFIG_HUSH_PARSER=y
+# CONFIG_AUTO_COMPLETE is not set
+CONFIG_SYS_PROMPT="ast# "
+CONFIG_CMD_MEMTEST=y
+CONFIG_SYS_ALT_MEMTEST=y
+CONFIG_CMD_CLK=y
+CONFIG_CMD_GPIO=y
+CONFIG_CMD_I2C=y
+CONFIG_CMD_PCI=y
+CONFIG_CMD_MMC=y
+CONFIG_CMD_SF=y
+CONFIG_CMD_DHCP=y
+CONFIG_CMD_MII=y
+CONFIG_CMD_PING=y
+CONFIG_DEFAULT_DEVICE_TREE="ast2600-goldentalon"
+CONFIG_ENV_IS_IN_SPI_FLASH=y
+CONFIG_USE_ENV_SPI_BUS=y
+CONFIG_ENV_SPI_BUS=0
+CONFIG_USE_ENV_SPI_CS=y
+CONFIG_ENV_SPI_CS=0
+CONFIG_USE_ENV_SPI_MAX_HZ=y
+CONFIG_ENV_SPI_MAX_HZ=100000000
+CONFIG_NET_RANDOM_ETHADDR=y
+CONFIG_REGMAP=y
+CONFIG_SYSCON=y
+CONFIG_CLK=y
+CONFIG_DM_GPIO=y
+CONFIG_ASPEED_GPIO=y
+CONFIG_DM_I2C=y
+CONFIG_SYS_I2C_ASPEED=y
+CONFIG_MISC=y
+CONFIG_ASPEED_AHBC=y
+CONFIG_ASPEED_H2X=y
+CONFIG_DM_MMC=y
+CONFIG_MMC_SDHCI=y
+CONFIG_MMC_SDHCI_ASPEED=y
+CONFIG_DM_SPI_FLASH=y
+CONFIG_SPI_FLASH=y
+CONFIG_SPI_FLASH_GIGADEVICE=y
+CONFIG_SPI_FLASH_MACRONIX=y
+CONFIG_SPI_FLASH_SPANSION=y
+CONFIG_SPI_FLASH_STMICRO=y
+CONFIG_SPI_FLASH_WINBOND=y
+CONFIG_PHY_BROADCOM=y
+CONFIG_PHY_REALTEK=y
+CONFIG_DM_ETH=y
+CONFIG_FTGMAC100=y
+CONFIG_MDIO=y
+CONFIG_PCI=y
+CONFIG_DM_PCI=y
+CONFIG_DM_PCI_COMPAT=y
+CONFIG_PCIE_ASPEED=y
+CONFIG_PHY=y
+CONFIG_PINCTRL=y
+CONFIG_DM_SERIAL=y
+CONFIG_SYS_NS16550=y
+CONFIG_SPI=y
+CONFIG_DM_SPI=y
+CONFIG_SYSRESET=y
+CONFIG_WDT=y
diff --git a/include/configs/aspeed-common.h b/include/configs/aspeed-common.h
index 8769587..67fe437 100755
--- a/include/configs/aspeed-common.h
+++ b/include/configs/aspeed-common.h
@@ -11,7 +11,7 @@
 
 #include <asm/arch/platform.h>
 
-#define CONFIG_BOOTFILE		"all.bin"
+#define CONFIG_BOOTFILE		"image-bmc"
 
 #define CONFIG_GATEWAYIP	192.168.0.1
 #define CONFIG_NETMASK		255.255.255.0
@@ -55,6 +55,9 @@
 /*
  * Miscellaneous configurable options
  */
+#ifndef CONFIG_BOOTCOMMAND
+#define CONFIG_BOOTCOMMAND		"bootm 20100000"
+#endif
 #define CONFIG_SYS_BOOTM_LEN 		(0x800000 * 2)
 
 #define CONFIG_EXTRA_ENV_SETTINGS \
diff --git a/include/configs/evb_ast2600a0.h b/include/configs/evb_ast2600a0.h
index 4592c85..79eccbf 100644
--- a/include/configs/evb_ast2600a0.h
+++ b/include/configs/evb_ast2600a0.h
@@ -16,4 +16,9 @@
 /* Memory Info */
 #define CONFIG_SYS_LOAD_ADDR		0x83000000
 
+/* Environment */
+#define CONFIG_ENV_SIZE			0x10000
+#define CONFIG_ENV_OFFSET		0xe0000
+#define CONFIG_ENV_SECT_SIZE		(4 << 10)
+
 #endif	/* __CONFIG_H */
-- 
2.7.4

