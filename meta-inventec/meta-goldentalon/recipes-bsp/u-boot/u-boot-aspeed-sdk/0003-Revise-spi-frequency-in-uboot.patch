From f52f42f364fb92378627be44b68d8652d3f11955 Mon Sep 17 00:00:00 2001
From: anonymous <anonymous@inventec.com>
Date: Wed, 1 Jul 2020 16:54:42 +0800
Subject: [PATCH 3/5] Revise spi frequency in uboot

Revise spi frequency in uboot
---
 arch/arm/dts/ast2600-goldentalon.dts | 14 +++++++-------
 drivers/spi/aspeed_spi.c             |  2 +-
 2 files changed, 8 insertions(+), 8 deletions(-)

diff --git a/arch/arm/dts/ast2600-goldentalon.dts b/arch/arm/dts/ast2600-goldentalon.dts
index e8e477d..c279a17 100644
--- a/arch/arm/dts/ast2600-goldentalon.dts
+++ b/arch/arm/dts/ast2600-goldentalon.dts
@@ -80,7 +80,7 @@
 	flash@0 {
 		compatible = "spi-flash", "sst,w25q256";
 		status = "okay";
-		spi-max-frequency = <50000000>;
+		spi-max-frequency = <33333334>;
 		spi-tx-bus-width = <2>;
 		spi-rx-bus-width = <2>;
 	};
@@ -88,7 +88,7 @@
 	flash@1 {
 		compatible = "spi-flash", "sst,w25q256";
 		status = "okay";
-		spi-max-frequency = <33000000>;
+		spi-max-frequency = <33333334>;
 		spi-tx-bus-width = <2>;
 		spi-rx-bus-width = <2>;
     };
@@ -105,7 +105,7 @@
 	flash@0 {
 		compatible = "spi-flash", "sst,w25q256";
 		status = "okay";
-		spi-max-frequency = <33000000>;
+		spi-max-frequency = <33333334>;
 		spi-tx-bus-width = <2>;
 		spi-rx-bus-width = <2>;
 	};
@@ -113,7 +113,7 @@
 	flash@1 {
 		compatible = "spi-flash", "sst,w25q256";
 		status = "okay";
-		spi-max-frequency = <33000000>;
+		spi-max-frequency = <33333334>;
 		spi-tx-bus-width = <2>;
 		spi-rx-bus-width = <2>;
 	};
@@ -129,7 +129,7 @@
 	flash@0 {
 		compatible = "spi-flash", "sst,w25q256";
 		status = "okay";
-		spi-max-frequency = <33000000>;
+		spi-max-frequency = <33333334>;
 		spi-tx-bus-width = <2>;
 		spi-rx-bus-width = <2>;
 	};
@@ -137,7 +137,7 @@
 	flash@1 {
 		compatible = "spi-flash", "sst,w25q256";
 		status = "okay";
-		spi-max-frequency = <33000000>;
+		spi-max-frequency = <33333334>;
 		spi-tx-bus-width = <2>;
 		spi-rx-bus-width = <2>;
 	};
@@ -145,7 +145,7 @@
 	flash@2 {
 		compatible = "spi-flash", "sst,w25q256";
 		status = "okay";
-		spi-max-frequency = <33000000>;
+		spi-max-frequency = <33333334>;
 		spi-tx-bus-width = <2>;
 		spi-rx-bus-width = <2>;
 	};
diff --git a/drivers/spi/aspeed_spi.c b/drivers/spi/aspeed_spi.c
index 18d4c2f..d970389 100644
--- a/drivers/spi/aspeed_spi.c
+++ b/drivers/spi/aspeed_spi.c
@@ -215,7 +215,7 @@ static u32 aspeed_g6_spi_hclk_divisor(struct aspeed_spi_priv *priv, u32 max_hz)
 		for (i = 0; i < ARRAY_SIZE(hclk_masks); i++) {
 			base_div = j * 16;
 			if (max_hz >= (hclk_rate / ((i + 1) + base_div))) {
-				
+				printf(" max_hz = %d \n", hclk_rate / ((i + 1) + base_div));
 				done = 1;
 				break;
 			}
-- 
2.7.4

